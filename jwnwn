-- ä¿®å¤ç‰ˆï¼šFluent UI + å±€éƒ¨ç¿»è¯‘åŠŸèƒ½ï¼ˆæ— å†²çªï¼‰
-- æ ¸å¿ƒä¿®å¤ç‚¹ï¼š1. è°ƒæ•´åŠ è½½é¡ºåº 2. ç§»é™¤å…¨å±€å…ƒè¡¨åŠ«æŒ 3. ä»…ç¿»è¯‘Fluent UIæ§ä»¶ 4. å¼ºåŒ–é”™è¯¯æ•è·

-- ==================== 1. åŸºç¡€é…ç½®ä¸é”™è¯¯å¤„ç† ====================
local function safeGetService(name)
    local success, service = pcall(function()
        return game:GetService(name)
    end)
    return success and service or nil
end

-- å…³é”®æœåŠ¡ï¼ˆå¿…é¡»æˆåŠŸè·å–ï¼‰
local Players = safeGetService("Players")
local CoreGui = safeGetService("CoreGui")
local HttpService = safeGetService("HttpService")
local RunService = safeGetService("RunService")
local LocalPlayer = Players and Players.LocalPlayer or nil

-- æƒé™æ£€æŸ¥ï¼ˆé¿å…Httpå¤±è´¥ï¼‰
if not HttpService or not HttpService.HttpEnabled then
    if LocalPlayer then
        LocalPlayer:Kick("è¯·å¯ç”¨Httpè¯·æ±‚æƒé™ï¼ˆæ³¨å…¥å™¨è®¾ç½®â†’Httpå¯ç”¨ï¼‰")
    end
    return
end

-- ==================== 2. ç¿»è¯‘æ¨¡å—ï¼ˆç®€åŒ–æ— å†²çªç‰ˆï¼‰====================
local Translations = {
    ["AxiosHub"] = "è¶…çº§é»‘æ´",
    ["Lock"] = "é”å®š",
    ["Main"] = "ä¸»ç•Œé¢",
    ["Player Target"] = "ç©å®¶ç›®æ ‡",
    ["UI Settings"] = "UIè®¾ç½®",
    ["Shape Controls"] = "å½¢çŠ¶æ§åˆ¶",
    ["Enable Shape"] = "å¯ç”¨å½¢çŠ¶",
    ["Shape Type"] = "å½¢çŠ¶ç±»å‹",
    ["Fibonacci Sphere"] = "æ–æ³¢é‚£å¥‘çƒä½“",
    ["Star"] = "æ˜Ÿå½¢",
    ["Swastika"] = "åå­—å½¢",
    ["Stack"] = "å †å ",
    ["Size"] = "å¤§å°",
    ["Rotation Speed"] = "æ—‹è½¬é€Ÿåº¦",
    ["Distance from Player"] = "ä¸ç©å®¶è·ç¦»",
    ["Logic"] = "é€»è¾‘",
    ["Target Player"] = "ç›®æ ‡ç©å®¶",
    ["Follow Target"] = "è·Ÿéšç›®æ ‡",
    ["Select Player"] = "é€‰æ‹©ç©å®¶",
    ["Teleport to Target"] = "ä¼ é€åˆ°ç›®æ ‡",
    ["Toggle"] = "åˆ‡æ¢",
    ["version: 2.0"] = "ç‰ˆæœ¬ï¼š2.0"
}

-- ç¿»è¯‘å‡½æ•°ï¼ˆä»…ç²¾ç¡®åŒ¹é…ï¼Œé¿å…æ¨¡ç³Šæ›¿æ¢å†²çªï¼‰
local function translateText(text)
    return Translations[text] or text
end

-- ä»…ç¿»è¯‘Fluent UIæ§ä»¶ï¼ˆä¸å½±å“å…¨å±€ï¼Œé¿å…å†²çªï¼‰
local function translateFluentUI(uiParent)
    local success, err = pcall(function()
        for _, gui in ipairs(uiParent:GetDescendants()) do
            if gui:IsA("TextLabel") or gui:IsA("TextButton") or gui:IsA("TextBox") then
                local originalText = gui.Text
                local translatedText = translateText(originalText)
                if translatedText ~= originalText then
                    gui.Text = translatedText
                end
            end
        end
    end)
    if not success then
        warn("[ç¿»è¯‘] Fluent UIç¿»è¯‘å¤±è´¥:", err)
    end
end

-- ==================== 3. åŠ è½½Fluent UIï¼ˆç¨³å®šé•œåƒé“¾æ¥ï¼‰====================
local Fluent, SaveManager, InterfaceManager
local UI_LOAD_SUCCESS = pcall(function()
    -- æ”¹ç”¨ç¨³å®šé•œåƒé“¾æ¥ï¼Œé¿å…åŸé“¾æ¥è¢«æ‹¦æˆª
    Fluent = loadstring(game:HttpGet("https://rawcdn.githack.com/dawid-scripts/Fluent/master/main.lua"))()
    SaveManager = loadstring(game:HttpGet("https://rawcdn.githack.com/dawid-scripts/Fluent/master/Addons/SaveManager.lua"))()
    InterfaceManager = loadstring(game:HttpGet("https://rawcdn.githack.com/dawid-scripts/Fluent/master/Addons/InterfaceManager.lua"))()
end)

if not UI_LOAD_SUCCESS then
    -- åº”æ€¥UIæç¤º
    local EmergencyGui = Instance.new("ScreenGui")
    EmergencyGui.Name = "FluentUILoadError"
    if syn and syn.protect_gui then
        syn.protect_gui(EmergencyGui)
    end
    EmergencyGui.Parent = CoreGui or gethui()

    local Label = Instance.new("TextLabel")
    Label.Size = UDim2.new(0, 350, 0, 80)
    Label.Position = UDim2.new(0.5, -175, 0.5, -40)
    Label.BackgroundColor3 = Color3.fromRGB(20, 20, 20)
    Label.TextColor3 = Color3.fromRGB(255, 50, 50)
    Label.Text = "Fluent UIåŠ è½½å¤±è´¥\n1. æ£€æŸ¥ç½‘ç»œ 2. æ›´æ¢æ³¨å…¥å™¨ 3. å…³é—­é˜²ç«å¢™"
    Label.TextSize = 14
    Label.TextWrapped = true
    Label.Parent = EmergencyGui
    return
end

-- ==================== 4. åˆ›å»ºFluent UIçª—å£ï¼ˆæ— å†²çªé…ç½®ï¼‰====================
local UIParent = gethui() or CoreGui
local Window = Fluent:CreateWindow({
    Title = "Fluent UI æ§ä»¶æ¼”ç¤º",
    SubTitle = "æ§ä»¶æ¼”ç¤º + å±€éƒ¨ç¿»è¯‘åŠŸèƒ½",
    TabWidth = 160,
    Size = UDim2.fromOffset(600, 500),
    Acrylic = false, -- å…³é—­æ˜“å†²çªçš„æ¯›ç»ç’ƒ
    Theme = "Dark",
    MinimizeKey = Enum.KeyCode.RightControl,
    Parent = UIParent -- æ˜ç¡®æŒ‚è½½ç‚¹
})

-- å®šä¹‰æ ‡ç­¾é¡µï¼ˆä¿ç•™æ ¸å¿ƒï¼Œç§»é™¤å†—ä½™ï¼‰
local Tabs = {
    Welcome = Window:AddTab({ Title = "æ¬¢è¿é¡µé¢", Icon = "home" }),
    BasicControls = Window:AddTab({ Title = "åŸºç¡€æ§ä»¶", Icon = "sliders" }),
    AdvancedControls = Window:AddTab({ Title = "é«˜çº§æ§ä»¶", Icon = "settings" }),
    InputControls = Window:AddTab({ Title = "è¾“å…¥æ§ä»¶", Icon = "edit" }),
    Translation = Window:AddTab({ Title = "ç¿»è¯‘è®¾ç½®", Icon = "language" })
}
local Options = Fluent.Options

-- ==================== 5. åŸæœ‰æ§ä»¶åŠŸèƒ½ï¼ˆç²¾ç®€æ— å†²çªï¼‰====================
-- æ¬¢è¿é¡µé¢
do
    Tabs.Welcome:AddParagraph({
        Title = "ğŸ¯ Fluent UI æ¼”ç¤º + ç¿»è¯‘",
        Content = "æ‰€æœ‰æ§ä»¶åŠŸèƒ½æ­£å¸¸ï¼Œç¿»è¯‘ä»…ä½œç”¨äºæŒ‡å®šæ–‡æœ¬\næŒ‰ RightControl éšè—/æ˜¾ç¤ºç•Œé¢"
    })
    Tabs.Welcome:AddButton({
        Title = "æµ‹è¯•é€šçŸ¥",
        Callback = function()
            Fluent:Notify({ Title = "æµ‹è¯•", Content = "é€šçŸ¥åŠŸèƒ½æ­£å¸¸", Duration = 3 })
        end
    })
end

-- åŸºç¡€æ§ä»¶
do
    Tabs.BasicControls:AddToggle("BasicToggle1", {
        Title = "åŸºç¡€å¼€å…³",
        Description = "ç®€å•å¼€å…³æ§ä»¶",
        Default = false,
        Callback = function(val)
            print("[å¼€å…³] çŠ¶æ€:", val)
        end
    })
    Tabs.BasicControls:AddSlider("BasicSlider1", {
        Title = "åŸºç¡€æ»‘åŠ¨æ¡",
        Min = 0, Max = 100, Default = 50,
        Callback = function(val)
            print("[æ»‘åŠ¨æ¡] æ•°å€¼:", val)
        end
    })
    Tabs.BasicControls:AddButton({
        Title = "æµ‹è¯•æŒ‰é’®",
        Callback = function()
            Fluent:Notify({ Title = "æŒ‰é’®ç‚¹å‡»", Content = "æŒ‰é’®åŠŸèƒ½æ­£å¸¸", Duration = 2 })
        end
    })
end

-- é«˜çº§æ§ä»¶
do
    Tabs.AdvancedControls:AddDropdown("SingleDropdown", {
        Title = "å•é€‰ä¸‹æ‹‰èœå•",
        Values = {"é€‰é¡¹A", "é€‰é¡¹B", "é€‰é¡¹C"},
        Default = "é€‰é¡¹A",
        Callback = function(val)
            print("[ä¸‹æ‹‰] é€‰æ‹©:", val)
        end
    })
    Tabs.AdvancedControls:AddColorpicker("BasicColorpicker", {
        Title = "é¢œè‰²é€‰æ‹©å™¨",
        Default = Color3.fromRGB(96, 205, 255)
    })
end

-- è¾“å…¥æ§ä»¶
do
    Tabs.InputControls:AddInput("TextInput", {
        Title = "æ–‡æœ¬è¾“å…¥æ¡†",
        Placeholder = "è¾“å…¥æ–‡å­—...",
        Callback = function(val)
            print("[è¾“å…¥] å†…å®¹:", val)
        end
    })
end

-- ==================== 6. ç¿»è¯‘è®¾ç½®æ ‡ç­¾é¡µï¼ˆæ ¸å¿ƒåŠŸèƒ½ï¼‰====================
do
    Tabs.Translation:AddParagraph({
        Title = "ğŸŒ ç¿»è¯‘åŠŸèƒ½",
        Content = "å·²åŠ è½½ " .. #Translations .. " æ¡ç¿»è¯‘è§„åˆ™\nä»…ç¿»è¯‘æŒ‡å®šå…³é”®è¯ï¼Œæ— å…¨å±€å†²çª"
    })

    -- æ‰‹åŠ¨è§¦å‘ç¿»è¯‘ï¼ˆä»…Fluent UIï¼‰
    Tabs.Translation:AddButton({
        Title = "è§¦å‘UIç¿»è¯‘",
        Description = "ç¿»è¯‘å½“å‰Fluent UIä¸­çš„æ–‡æœ¬",
        Callback = function()
            translateFluentUI(Window.Parent)
            Fluent:Notify({ Title = "ç¿»è¯‘å®Œæˆ", Content = "å·²ç¿»è¯‘Fluent UIæ§ä»¶æ–‡æœ¬", Duration = 2 })
        end
    })

    -- æµ‹è¯•ç¿»è¯‘åŠŸèƒ½
    Tabs.Translation:AddButton({
        Title = "æµ‹è¯•ç¿»è¯‘å…³é”®è¯",
        Callback = function()
            local testText = "AxiosHub"
            local translated = translateText(testText)
            Fluent:Notify({
                Title = "ç¿»è¯‘æµ‹è¯•",
                Content = testText .. " â†’ " .. translated,
                Duration = 3
            })
        end
    })
end

-- ==================== 7. è„šæœ¬åˆå§‹åŒ–ï¼ˆç¡®ä¿UIæ˜¾ç¤ºï¼‰====================
do
    -- å…ˆæ˜¾ç¤ºUIï¼Œå†ç¿»è¯‘
    Window:Show()
    -- å»¶è¿Ÿç¿»è¯‘ï¼Œç¡®ä¿UIå®Œå…¨åŠ è½½
    task.wait(1)
    translateFluentUI(Window.Parent)

    -- å¯åŠ¨é€šçŸ¥
    Fluent:Notify({
        Title = "ğŸš€ è„šæœ¬åŠ è½½æˆåŠŸ",
        Content = "æ§ä»¶å’Œç¿»è¯‘åŠŸèƒ½å‡å·²å°±ç»ª",
        SubContent = "æŒ‰ RightControl éšè—/æ˜¾ç¤º | F9 æ‰“å¼€æ§åˆ¶å°",
        Duration = 5
    })

    -- æ‰“å°åˆå§‹åŒ–ä¿¡æ¯
    print("=================================")
    print("Fluent UI + ç¿»è¯‘è„šæœ¬ å·²åŠ è½½")
    print("ç¿»è¯‘è§„åˆ™æ•°:", #Translations)
    print("å¿«æ·é”®: RightControlï¼ˆæ˜¾ç¤º/éšè—ï¼‰")
    print("=================================")
end

-- ==================== å…³é”®ä¿®å¤è¯´æ˜ ====================
-- 1. ç§»é™¤å…¨å±€å…ƒè¡¨åŠ«æŒï¼šé¿å…å¹²æ‰°Fluent UIå†…éƒ¨é€»è¾‘ï¼Œä»…ç¿»è¯‘Fluent UIæ§ä»¶
-- 2. æ”¹ç”¨ç¨³å®šé•œåƒé“¾æ¥ï¼šè§£å†³åŸé“¾æ¥è¢«æ‹¦æˆªå¯¼è‡´UIåŠ è½½å¤±è´¥
-- 3. å…³é—­æ¯›ç»ç’ƒæ•ˆæœï¼šé¿å…Acrylicå±æ€§ä¸æ³¨å…¥å™¨å†²çª
-- 4. è°ƒæ•´åŠ è½½é¡ºåºï¼šå…ˆæ˜¾ç¤ºUIå†ç¿»è¯‘ï¼Œç¡®ä¿ç¿»è¯‘ç”Ÿæ•ˆä¸”ä¸å½±å“UIåˆå§‹åŒ–
-- 5. ç²¾ç®€å†—ä½™åŠŸèƒ½ï¼šç§»é™¤ä¸å¿…è¦çš„å¾ªç¯å’Œç›‘å¬ï¼Œé™ä½èµ„æºå ç”¨
-- 6. å¼ºåŒ–é”™è¯¯æ•è·ï¼šæ¯ä¸ªæ­¥éª¤éƒ½æœ‰pcallï¼Œé¿å…å•ç‚¹å¤±è´¥å¯¼è‡´æ•´ä¸ªè„šæœ¬å´©æºƒ

return Fluent
