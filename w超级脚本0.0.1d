-- Delta é€‚é…ï¼šç®€åŒ–å…¨å±€å˜é‡ï¼ˆé¿å… Delta æ³¨å…¥å™¨é™åˆ¶ï¼‰
local Global = {
    WindUI = nil,
    MainWindow = nil,
    noclipConnection = nil,
    nightVisionEnabled = false,
    currentWalkSpeed = 16,
    currentJumpPower = 50,
    godmodeEnabled = false,
    autoswingEnabled = false,
    wallhopConnection = nil, -- æ–°å¢ï¼šè·³å¢™åŠŸèƒ½è¿æ¥å­˜å‚¨
    rainbowAnimationConnection = nil, -- æ–°å¢ï¼šå½©è™¹åŠ¨ç”»è¿æ¥å­˜å‚¨
    flyConnection = nil, -- æ–°å¢ï¼šé£è¡ŒåŠŸèƒ½è¿æ¥å­˜å‚¨ï¼ˆDelta ä¿æ´»ç”¨ï¼‰
    creatorTagInstances = {}, -- æ–°å¢ï¼šå­˜å‚¨åˆ¶ä½œè€…æ ‡ç­¾å®ä¾‹ï¼Œä¾¿äºç®¡ç†
    welcomeSent = false, -- æ–°å¢ï¼šæ ‡è®°æ˜¯å¦å·²å‘é€æ¬¢è¿ä¿¡æ¯ï¼Œé¿å…é‡å¤
    translationCache = {} -- æ–°å¢ï¼šç¿»è¯‘ç¼“å­˜ï¼Œå‡å°‘é‡å¤è¯·æ±‚
}

-- Delta å…¼å®¹ï¼šæ¡†æ¶åŠ è½½ï¼ˆæ›¿æ¢ä¸º Delta æ”¯æŒçš„ HttpGet æ–¹å¼ï¼‰
local success, WindUI = pcall(function()
    local framework = game:HttpGet("https://raw.githubusercontent.com/Footagesus/WindUI/main/dist/main.lua")
    return loadstring(framework)()
end)

if not success then
    -- Delta é€‚é…ï¼šä½¿ç”¨åŸç”Ÿé€šçŸ¥ï¼ˆé¿å… SetCore å…¼å®¹æ€§é—®é¢˜ï¼‰
    local notification = Instance.new("ScreenGui")
    notification.Name = "LoadFailNotice"
    notification.Parent = game.Players.LocalPlayer.PlayerGui
    local textLabel = Instance.new("TextLabel")
    textLabel.Size = UDim2.fromOffset(300, 80)
    textLabel.Position = UDim2.fromScale(0.5, 0.1)
    textLabel.AnchorPoint = Vector2.new(0.5, 0.5)
    textLabel.BackgroundColor3 = Color3.new(0, 0, 0)
    textLabel.TextColor3 = Color3.new(1, 0, 0)
    textLabel.Text = "WindUI æ¡†æ¶åŠ è½½å¤±è´¥\nè¯·æ£€æŸ¥ç½‘ç»œæˆ–æ›´æ–° Delta æ³¨å…¥å™¨"
    textLabel.TextWrapped = true
    textLabel.Parent = notification
    task.wait(5)
    notification:Destroy()
    return
end

Global.WindUI = WindUI

-- é¢„åŠ è½½æ‰€æœ‰å¿…éœ€æœåŠ¡ï¼ˆDelta æ³¨å…¥å™¨éœ€æ˜¾å¼è·å–ï¼‰
local LocalPlayer = game.Players.LocalPlayer
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local Workspace = game:GetService("Workspace")
local RunService = game:GetService("RunService")
local Lighting = game:GetService("Lighting")
local MarketplaceService = game:GetService("MarketplaceService")
local CoreGui = game:GetService("CoreGui") -- é¢„åŠ è½½ CoreGui ç”¨äºæ‚¬æµ®çª—ç»‘å®š
local Confirmed = false

-- è§’è‰²åŠ è½½æ£€æµ‹å‡½æ•°ï¼ˆDelta é€‚é…ï¼šå¢åŠ è¶…æ—¶å¤„ç†ï¼‰
local function waitForCharacter()
    local timeout = 0
    while not LocalPlayer.Character or not LocalPlayer.Character:FindFirstChild("HumanoidRootPart") do
        task.wait(0.1)
        timeout += 0.1
        if timeout >= 10 then -- 10ç§’è¶…æ—¶
            return nil
        end
    end
    return LocalPlayer.Character
end

-- æ–°å¢ï¼šå½©è™¹è‰²ç”Ÿæˆå‡½æ•°ï¼ˆé€šè¿‡è‰²ç›¸å¾ªç¯å®ç°ï¼‰
local function getRainbowColor(hueOffset)
    local hue = (tick() * 0.2 + hueOffset) % 1 -- 0.2 æ§åˆ¶å˜è‰²é€Ÿåº¦ï¼Œå€¼è¶Šå¤§è¶Šå¿«
    return Color3.fromHSV(hue, 0.8, 0.9) -- é¥±å’Œåº¦0.8ã€æ˜åº¦0.9ï¼Œé¢œè‰²æ›´é²œè‰³
end

-- æ–°å¢ï¼šå¯åŠ¨å°çª—å½©è™¹åŠ¨ç”»
local function startRainbowAnimation(openButton)
    -- å…ˆå…³é—­å·²æœ‰åŠ¨ç”»ï¼Œé¿å…é‡å¤
    if Global.rainbowAnimationConnection then
        Global.rainbowAnimationConnection:Disconnect()
    end

    -- æ¯å¸§æ›´æ–°é¢œè‰²ï¼ˆä½¿ç”¨ RenderStepped ç¡®ä¿UIåŒæ­¥ï¼‰
    Global.rainbowAnimationConnection = RunService.RenderStepped:Connect(function()
        if openButton and openButton.Parent then
            -- ç”Ÿæˆå½©è™¹æ¸å˜ï¼ˆä¸¤ç§ç›¸é‚»å½©è™¹è‰²ï¼Œè®©å…‰åœˆæœ‰æ¸å˜å…‰æ³½ï¼‰
            local color1 = getRainbowColor(0)
            local color2 = getRainbowColor(0.1) -- åç§»è‰²ç›¸ï¼Œå½¢æˆæ¸å˜
            openButton.Color = ColorSequence.new(color1, color2)
        else
            -- å°çª—ä¸å­˜åœ¨æ—¶æ–­å¼€åŠ¨ç”»
            Global.rainbowAnimationConnection:Disconnect()
            Global.rainbowAnimationConnection = nil
        end
    end)
end

-- ==================== æ–°å¢ï¼šç¿»è¯‘åŠŸèƒ½æ ¸å¿ƒå‡½æ•°ï¼ˆDelta é€‚é…ï¼‰ ====================
local function translateText(text, fromLang, toLang)
    -- å‚æ•°éªŒè¯
    if not text or text == "" then
        return "è¯·è¾“å…¥éœ€è¦ç¿»è¯‘çš„æ–‡æœ¬"
    end
   Â 
    -- æ£€æŸ¥ç¼“å­˜ï¼Œé¿å…é‡å¤è¯·æ±‚
    local cacheKey = text .. "|" .. fromLang .. "|" .. toLang
    if Global.translationCache[cacheKey] then
        return Global.translationCache[cacheKey]
    end
   Â 
    -- Delta é€‚é…ï¼šä½¿ç”¨å…¬å¼€ç¿»è¯‘APIï¼Œå…¼å®¹æ³¨å…¥å™¨é™åˆ¶
    local success, result = pcall(function()
        -- ç¼–ç æ–‡æœ¬ä¸ºURLå®‰å…¨æ ¼å¼
        local encodedText = game:GetService("HttpService"):UrlEncode(text)
        -- ä½¿ç”¨å…¬å¼€ç¿»è¯‘æ¥å£ï¼ˆç¤ºä¾‹æ¥å£ï¼Œå®é™…ä½¿ç”¨æ—¶å¯æ›¿æ¢ä¸ºç¨³å®šæ¥å£ï¼‰
        local url = string.format("https://translate.googleapis.com/translate_a/single?client=gtx&sl=%s&tl=%s&dt=t&q=%s",
            fromLang, toLang, encodedText)
       Â 
        local response = game:HttpGet(url, true)
        -- è§£æJSONå“åº”ï¼ˆç®€åŒ–å¤„ç†ï¼‰
        local decoded = game:GetService("HttpService"):JSONDecode(response)
        -- æå–ç¿»è¯‘ç»“æœ
        local translated = ""
        for _, segment in ipairs(decoded[1]) do
            translated = translated .. segment[1]
        end
        return translated
    end)
   Â 
    if success and result and result ~= "" then
        Global.translationCache[cacheKey] = result -- å­˜å…¥ç¼“å­˜
        return result
    else
        return "ç¿»è¯‘å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œæˆ–æ–‡æœ¬"
    end
end

-- ==================== æ–°å¢ï¼šåˆ¶ä½œè€…æ ‡ç­¾åˆ›å»ºå‡½æ•°ï¼ˆDelta é€‚é…ï¼‰ ====================
local function createCreatorTag(player)
    -- å®‰å…¨æ£€æŸ¥ï¼šç¡®ä¿ç©å®¶è§’è‰²å·²åŠ è½½
    local char = player.Character or player.CharacterAdded:Wait()
    local humanoidRootPart = char:WaitForChild("HumanoidRootPart", 10)
    if not humanoidRootPart then return end

    -- é¿å…é‡å¤åˆ›å»ºæ ‡ç­¾
    if Global.creatorTagInstances[player.UserId] then
        Global.creatorTagInstances[player.UserId]:Destroy()
    end

    -- Delta é€‚é…ï¼šç”¨ pcall åŒ…è£¹ UI åˆ›å»ºï¼Œé¿å…æ¸²æŸ“é”™è¯¯
    local success, billboardGui = pcall(function()
        -- åˆ›å»º BillboardGuiï¼ˆå¤´é¡¶æ ‡ç­¾å®¹å™¨ï¼‰
        local bg = Instance.new("BillboardGui")
        bg.Name = "CreatorTag"
        bg.Adornee = humanoidRootPart
        bg.Size = UDim2.fromOffset(200, 50)
        bg.AlwaysOnTop = true -- å§‹ç»ˆæ˜¾ç¤ºåœ¨æœ€ä¸Šå±‚
        bg.ZIndexBehavior = Enum.ZIndexBehavior.Sibling
        bg.Parent = char -- çˆ¶å¯¹è±¡è®¾ä¸ºè§’è‰²ï¼Œé¿å… Delta å›æ”¶

        -- åˆ›å»ºæ ‡ç­¾èƒŒæ™¯
        local background = Instance.new("Frame")
        background.Size = UDim2.fromScale(1, 1)
        background.BackgroundColor3 = Color3.new(0, 0, 0)
        background.BorderColor3 = Color3.new(1, 1, 0) -- é‡‘è‰²è¾¹æ¡†
        background.BorderSizePixel = 2
        background.CornerRadius = UDim.new(0, 8)
        background.Parent = bg

        -- åˆ›å»ºæ ‡ç­¾æ–‡æœ¬
        local textLabel = Instance.new("TextLabel")
        textLabel.Size = UDim2.fromScale(0.95, 0.95)
        textLabel.Position = UDim2.fromScale(0.025, 0.025)
        textLabel.BackgroundTransparent = true
        textLabel.Text = "wè¶…çº§è„šæœ¬åˆ¶ä½œè€…"
        textLabel.TextColor3 = Color3.new(1, 1, 0) -- é‡‘è‰²æ–‡æœ¬
        textLabel.TextFont = Enum.Font.Bold
        textLabel.TextSize = 18
        textLabel.TextWrapped = true
        textLabel.Parent = background

        return bg
    end)

    if success and billboardGui then
        Global.creatorTagInstances[player.UserId] = billboardGui
    end
end

-- ==================== æ–°å¢ï¼šè‡ªåŠ¨å‘é€æ¬¢è¿ä¿¡æ¯å‡½æ•°ï¼ˆDelta é€‚é…ï¼‰ ====================
local function sendWelcomeMessage()
    -- é¿å…é‡å¤å‘é€
    if Global.welcomeSent then return end
    Global.welcomeSent = true

    -- Delta é€‚é…ï¼šè·å–èŠå¤©æœåŠ¡å¹¶å‘é€ä¿¡æ¯ï¼Œç”¨ pcall æ•è·å‘é€é”™è¯¯
    local success = pcall(function()
        local chatService = ReplicatedStorage:WaitForChild("DefaultChatSystemChatEvents", 5)
        local sayMessageEvent = chatService:WaitForChild("SayMessageRequest", 5)
        if sayMessageEvent then
            -- å‘é€æ¬¢è¿ä¿¡æ¯
            sayMessageEvent:FireServer("æ¬¢è¿wè¶…çº§è„šæœ¬åˆ¶ä½œè€…æ¥åˆ°æ­¤æ¸¸æˆğŸ‰ğŸ‰æ¬¢è¿ä½¿ç”¨ W Super Script Center ğŸ‰ğŸ‰", "All")
        end
    end)

    if not success then
        -- å‘é€å¤±è´¥æ—¶æ˜¾ç¤ºé€šçŸ¥
        WindUI:Notify({
            Title = "æç¤º",
            Content = "æ¬¢è¿ä¿¡æ¯å‘é€å¤±è´¥ï¼Œè¯·æ£€æŸ¥èŠå¤©æƒé™",
            Duration = 3
        })
    end
end

-- ==================== æ–°å¢ï¼šåˆ¶ä½œè€…æ£€æµ‹ä¸»é€»è¾‘ï¼ˆDelta é€‚é…ï¼‰ ====================
local function detectCreator()
    -- æ£€æµ‹å·²å­˜åœ¨çš„ç©å®¶
    for _, player in ipairs(game.Players:GetPlayers()) do
        if player.Name == "wbwhnb" and player ~= LocalPlayer then
            createCreatorTag(player)
            sendWelcomeMessage()
        end
    end

    -- æ£€æµ‹æ–°åŠ å…¥çš„ç©å®¶
    game.Players.PlayerAdded:Connect(function(player)
        if player.Name == "wbwhnb" and player ~= LocalPlayer then
            createCreatorTag(player)
            sendWelcomeMessage()
        end
    end)

    -- ç©å®¶è§’è‰²é‡ç”Ÿåé‡æ–°åˆ›å»ºæ ‡ç­¾
    game.Players.PlayerAdded:Connect(function(player)
        if player.Name == "wbwhnb" and player ~= LocalPlayer then
            player.CharacterAdded:Connect(function()
                task.wait(1) -- ç­‰å¾…è§’è‰²åŠ è½½å®Œæˆ
                createCreatorTag(player)
            end)
        end
    end)
end

-- åˆå§‹å¼¹çª—ï¼ˆDelta é€‚é…ï¼šç®€åŒ–å¼¹çª—å‚æ•°ï¼‰
WindUI:Popup({
    Title = "w è¶…çº§è„šæœ¬",
    IconThemed = true,
    Content = "æ¬¢è¿ä½¿ç”¨ MR é™„å±è„šæœ¬ MR pio\nå½“å‰ç”¨æˆ·: " .. LocalPlayer.Name,
    Buttons = {
        { Title = "å–æ¶ˆ", Callback = function() end },
        { Title = "åŠ è½½è„šæœ¬", Callback = function() Confirmed = true; createMainUI() end }
    }
})

-- ä¸»UIåˆ›å»ºå‡½æ•°ï¼ˆä¿®å¤è¯­æ³•é—­åˆ+Deltaé€‚é…+å½©è™¹å°çª—ï¼‰
function createMainUI()
    -- Delta é€‚é…ï¼šçª—å£å‚æ•°ç®€åŒ–+æ–°å¢æœ€å°åŒ–å›è°ƒ
    local MainWindow = WindUI:CreateWindow({
        Title = "w è¶…çº§è„šæœ¬",
        Icon = "crown",
        Author = "wbwhnb (QQ: 2318995920)",
        Folder = "wSuperScript",
        Size = UDim2.fromOffset(600, 400),
        Theme = "Dark",
        SideBarWidth = 220,
        OnClose = function() MainWindow:Hide() end, -- å…³é—­æ—¶éšè—ï¼ˆä¿ç•™æ‚¬æµ®çª—ï¼‰
        OnMinimize = function() -- æ–°å¢ï¼šæœ€å°åŒ–å›è°ƒï¼Œç¡®ä¿æ‚¬æµ®çª—å¯è§
            MainWindow:Hide()
            local openButton = CoreGui:FindFirstChild("WindUI_OpenButton")
            if openButton then openButton.Visible = true end
        end,
    })
    Global.MainWindow = MainWindow

    -- çª—å£æŒ‰é’®æ ·å¼ï¼ˆDelta é€‚é…ï¼šç»‘å®š CoreGui+å½©è™¹è‰²åˆå§‹é…ç½®ï¼‰
    local function createOpenButton()
        local openButton = MainWindow:EditOpenButton({
            Title = "w è¶…çº§è„šæœ¬",
            Icon = "crown",
            CornerRadius = UDim.new(0, 10),
            StrokeThickness = 2,
            Color = ColorSequence.new(getRainbowColor(0), getRainbowColor(0.1)), -- åˆå§‹å½©è™¹è‰²
            Draggable = true,
            Parent = CoreGui, -- ç»‘å®šåˆ° CoreGuiï¼Œé¿å… Delta å›æ”¶
            ZIndex = 9999, -- æ‚¬æµ®åœ¨æœ€ä¸Šå±‚ï¼Œä¸è¢«é®æŒ¡
            Size = UDim2.fromOffset(120, 40), -- è°ƒæ•´å°çª—å¤§å°ï¼Œä¾¿äºç‚¹å‡»
        })
        -- å¯åŠ¨å½©è™¹åŠ¨ç”»
        startRainbowAnimation(openButton)
        return openButton
    end

    -- åˆå§‹åˆ›å»ºå°çª—å¹¶å¯åŠ¨åŠ¨ç”»
    local openButton = createOpenButton()

    -- ==================== ä½œè€…ä¿¡æ¯ Tab ====================
    local AuthorTab = MainWindow:Tab({ Title = "ä½œè€…ä¿¡æ¯", Icon = "user" })
    AuthorTab:Section({ Title = "è„šæœ¬ä½œè€…è¯¦æƒ…" })
    AuthorTab:Paragraph({ Text = "ä½œè€…: wbwhnb" })
    AuthorTab:Paragraph({ Text = "ä½œè€… QQ: 2318995920" })
    AuthorTab:Paragraph({ Text = "è„šæœ¬æ€§è´¨: å…è´¹å¼€æº" })
    AuthorTab:Button({
        Title = "å¤åˆ¶ä½œè€… QQ",
        Callback = function()
            setclipboard("2318995920")
            WindUI:Notify({ Title = "æç¤º", Content = "QQ å·²å¤åˆ¶åˆ°å‰ªè´´æ¿", Duration = 3 })
        end
    })

    -- ==================== é€šç”¨åŠŸèƒ½ Tab ====================
    local GeneralTab = MainWindow:Tab({ Title = "é€šç”¨åŠŸèƒ½", Icon = "settings" })
    GeneralTab:Section({ Title = "åŸºç¡€å±æ€§è°ƒæ•´" })

    -- é€Ÿåº¦è°ƒèŠ‚
    GeneralTab:Slider({
        Title = "ç§»åŠ¨é€Ÿåº¦",
        Min = 16,
        Max = 200,
        Default = Global.currentWalkSpeed,
        Color = Color3.new(0, 1, 1),
        Increment = 1,
        ValueName = "Speed",
        Callback = function(value)
            Global.currentWalkSpeed = value
            local char = waitForCharacter()
            if char then
                local humanoid = char:FindFirstChildOfClass("Humanoid")
                if humanoid then humanoid.WalkSpeed = value end
            end
        end
    })

    -- è·³è·ƒé«˜åº¦è°ƒèŠ‚
    GeneralTab:Slider({
        Title = "è·³è·ƒé«˜åº¦",
        Min = 50,
        Max = 200,
        Default = Global.currentJumpPower,
        Color = Color3.new(1, 0, 1),
        Increment = 1,
        ValueName = "Power",
        Callback = function(value)
            Global.currentJumpPower = value
            local char = waitForCharacter()
            if char then
                local humanoid = char:FindFirstChildOfClass("Humanoid")
                if humanoid then humanoid.JumpPower = value end
            end
        end
    })

    -- å¤œè§†æ¨¡å¼
    GeneralTab:Toggle({
        Title = "å¤œè§†æ¨¡å¼",
        Default = Global.nightVisionEnabled,
        Callback = function(state)
            Global.nightVisionEnabled = state
            if state then
                Lighting.Ambient = Color3.new(0.8, 0.8, 0.8)
                Lighting.OutdoorAmbient = Color3.new(0.6, 0.6, 0.6)
            else
                Lighting.Ambient = Color3.new(0.1, 0.1, 0.1)
                Lighting.OutdoorAmbient = Color3.new(0.2, 0.2, 0.2)
            end
        end
    })

    -- ç©¿å¢™æ¨¡å¼ï¼ˆDelta é€‚é…ï¼šé¿å…è¿æ¥æ³„éœ²ï¼‰
    GeneralTab:Toggle({
        Title = "ç©¿å¢™æ¨¡å¼",
        Default = false,
        Callback = function(state)
            if state then
                if not Global.noclipConnection then
                    Global.noclipConnection = RunService.Stepped:Connect(function()
                        local char = LocalPlayer.Character
                        if char then
                            for _, part in pairs(char:GetChildren()) do
                                if part:IsA("BasePart") then part.CanCollide = false end
                            end
                        end
                    end)
                end
            else
                if Global.noclipConnection then
                    Global.noclipConnection:Disconnect()
                    Global.noclipConnection = nil
                end
                local char = LocalPlayer.Character
                if char then
                    for _, part in pairs(char:GetChildren()) do
                        if part:IsA("BasePart") then part.CanCollide = true end
                    end
                end
            end
        end
    })

    -- æ— æ•Œæ¨¡å¼
    GeneralTab:Button({
        Title = "æ— æ•Œæ¨¡å¼",
        Callback = function()
            Global.godmodeEnabled = not Global.godmodeEnabled
            local char = waitForCharacter()
            if char then
                local humanoid = char:FindFirstChildOfClass("Humanoid")
                if humanoid then
                    if Global.godmodeEnabled then
                        humanoid.MaxHealth =
